[user]
    name = Austin McConnell
    email = austin.s.mcconnell@gmail.com
    signingkey = ~/.ssh/id_personal

[credential]
    helper = osxkeychain

[push]
    default = simple
    followTags = true
    autoSetupRemote = true
    useForceIfIncludes = true

[merge]
    ff = only
    conflictstyle = diff3  # delta-specific setting
    tool = vimdiff

[fetch]
    prune = true
    parallel = 0

[feature]
    manyFiles = true

[protocol]
    version = 2

[index]
    version = 4

[pack]
    useSparse = true

[clone]
    defaultRemoteName = origin

[alias]
    amend = commit --amend --reuse-message=HEAD
    contrib = shortlog --summary --numbered
    history = log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset%n%-N' --show-notes=*
    # Undo last commit and keep changes staged
    undo = "reset --soft HEAD^"
    # Stash changes as a WIP commit
    wip = "!git add . && git commit -m 'wip' --no-verify"
    # Select modified files to edit
    edit = "!git ls-files --modified --other --exclude-standard | sort --unique | fzf --exit-0 --multi --preview 'git diff --color {}' | xargs --no-run-if-empty --open-tty $EDITOR"
    edit-all = "!git ls-files --modified --other --exclude-standard | sort --unique | xargs --no-run-if-empty --open-tty --delimiter \"\n\" $EDITOR"
    # AI-enhanced Git operations
    ai-commit = "!q chat --agent default --no-interactive 'Generate a conventional commit message for the currently staged changes'"
    # Git Notes operations
    note = notes add
    noted = "!git log --oneline --show-notes=* | awk '/Notes:/{getline; print prev} {prev=$0}'"
    # Enhanced reflog matching history alias style
    reflog-pretty = reflog --format='%Cred%h%Creset -%C(yellow)%d%Creset %gs %Cgreen(%cr)%Creset %C(bold blue)<%an>%Creset'
    # Enhanced blame matching history alias style
    blame-pretty = blame -w --date=short --color-lines --no-follow
    # Blame ignoring formatting or refactor commits (requires .git-blame-ignore-revs file)
    blame-clean = blame -w --date=short --color-lines --no-follow --ignore-revs-file .git-blame-ignore-revs
    # Track file history through renames with patches
    file-history = log --follow --patch --color-words --
[init]
    templatedir = ~/.config/git/templates
    defaultBranch = main

[commit]
    gpgsign = true
    template = ~/.config/git/commit-template

[gpg]
    format = ssh

[pull]
    ff = only
    rebase = true

[rebase]
    autostash = true
    autosquash = true

[blame]
    date = short

[includeIf "gitdir:~/projects/unite-us/"]
    path = ./config-uniteus

[includeIf "gitdir:/Users"]
    path = ./config-macos

[includeIf "gitdir:/home"]
    path = ./config-linux

[submodule]
    recurse = true

[advice]
    skippedCherryPicks = false

############################################################
# Start delta-specific settings
# https://github.com/dandavison/delta
[core]
    pager = delta
    excludesfile = ~/.config/git/ignore
    untrackedcache = true
    preloadindex = true
    fsmonitor = true

[interactive]
    diffFilter = delta --color-only

[delta]
    features = nord-vscode-diff-colors
    navigate = true    # use n and N to move between diff sections
    side-by-side = true

[delta "nord-vscode-diff-colors"]
    syntax-theme = Nord
    minus-style = syntax "#7B343E"
    minus-emph-style = syntax "#773A44"
    minus-non-emph-style = syntax "#582A33"
    plus-style = syntax "#516059"
    plus-emph-style = syntax "#505F5D"
    plus-non-emph-style = syntax "#444F44"
    file-modified-label = "modified:"
    file-style = "yellow"
    map-styles = bold purple => syntax darkmagenta, bold cyan => syntax darkcyan

[diff]
    algorithm = histogram
    colorMoved = default
    compactionHeuristic = true
    indentHeuristic = true
    mnemonicPrefix = true
    renames = copies
    wordRegex = "[^[:space:]\":#]+"  # Exclude quotes, colons, hash from word boundaries
# End delta-specific settings
############################################################

[mergetool]
    prompt = false
    keepBackup = false
    hideResolved = true

[mergetool "vimdiff"]
    layout = "@LOCAL, REMOTE"  # equivalent to old vimdiff1
    ; layout = "LOCAL, MERGED, REMOTE"  # equivalent to old vimdiff2
    ; layout = "LOCAL,BASE,REMOTE / MERGED"  # equivalent to old vimdiff3

[color]
    ui = auto

[color "status"]
    added     = "#A3BE8C"  # Nord14 (green)
    changed   = "#EBCB8B"  # Nord13 (yellow)
    untracked = "#88C0D0"  # Nord8 (cyan)
    branch    = "#B48EAD"  # Nord15 (magenta)
    unmerged  = "#BF616A"  # Nord11 (red)

[rerere]
    enabled = true
    autoUpdate = true

[maintenance]
    auto = false
    strategy = incremental

[gc]
    writeCommitGraph = true
    autoDetach = false

[transfer]
    fsckObjects = true

[receive]
    fsckObjects = true

[fetch]
    fsckObjects = true
    writeCommitGraph = true

[notes]
    displayRef = refs/notes/*
    rewriteRef = refs/notes/*

[url "git@github.com:"]
    insteadOf = https://github.com/
    insteadOf = gh:
    pushInsteadOf = https://github.com/
