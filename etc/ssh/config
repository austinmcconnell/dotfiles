# Base SSH Configuration
# Machine-specific configs are in hosts.d/

# Include machine-specific configurations (must come before Host * for precedence)
Include ~/.ssh/hosts.d/*.conf

# Global settings
Host *
    UseKeychain yes
    AddKeysToAgent yes
    IdentitiesOnly yes
    ControlMaster auto
    # Using %r@%h:%p-%n instead of %C to create separate sockets for different host aliases
    # This prevents key conflicts when using both personal and github.com SSH aliases
    ControlPath ~/.ssh/controlmasters/%r@%h:%p-%n
    ControlPersist 4h
    TCPKeepAlive no
    ServerAliveInterval 60
    ServerAliveCountMax 30

# Kiro CLI SSH Integration. Keep at the bottom of this file.
Match all
  Include "~/Library/Application Support/kiro-cli/ssh"
